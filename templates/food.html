{% extends "base.html" %}

{% block title %}Restaurants - ONDA{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/food.css') }}">
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="food-hero">
    <div class="hero-overlay"></div>
    <div class="floating-foods">
        <div class="floating-food food-1">
            <i class="fas fa-utensils"></i>
        </div>
        <div class="floating-food food-2">
            <i class="fas fa-pizza-slice"></i>
        </div>
        <div class="floating-food food-3">
            <i class="fas fa-hamburger"></i>
        </div>
        <div class="floating-food food-4">
            <i class="fas fa-coffee"></i>
        </div>
    </div>
    <div class="container">
        <div class="row align-items-center min-vh-50">
            <div class="col-lg-6" data-aos="fade-right">
                <h1 class="hero-title">Restaurants & Gastronomie</h1>
                <p class="hero-subtitle">Découvrez une sélection exceptionnelle de restaurants dans nos aéroports et aux alentours, offrant une expérience culinaire authentique</p>
                <div class="hero-buttons">
                    <a href="#restaurant-search" class="btn btn-primary btn-lg me-3">
                        <i class="fas fa-search me-2"></i>Explorer
                    </a>
                    <a href="#restaurant-info" class="btn btn-outline-light btn-lg">
                        <i class="fas fa-info-circle me-2"></i>Informations
                    </a>
                </div>
            </div>
            <div class="col-lg-6" data-aos="fade-left">
                <div class="hero-stats">
                    <div class="stat-card" data-aos="fade-up" data-aos-delay="200">
                        <div class="stat-icon">
                            <i class="fas fa-store"></i>
                        </div>
                        <div class="stat-content">
                            <h3>{{ restaurants|length }}</h3>
                            <p>Restaurants</p>
                        </div>
                    </div>
                    <div class="stat-card" data-aos="fade-up" data-aos-delay="400">
                        <div class="stat-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-content">
                            <h3>4.5</h3>
                            <p>Note Moyenne</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Restaurant Search & Filters -->
<section id="restaurant-search" class="py-5">
    <div class="container">
        <div class="row">
            <!-- Sidebar Filters -->
            <div class="col-lg-3 mb-4">
                <div class="filter-sidebar" data-aos="fade-right">
                    <div class="filter-header">
                        <h4><i class="fas fa-filter me-2"></i>Filtres de Recherche</h4>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Ville</label>
                        <select class="form-select filter-select" id="cityFilter">
                            <option value="">Toutes les villes</option>
                            {% set cities = [] %}
                            {% for restaurant in restaurants %}
                                {% if restaurant.city not in cities %}
                                    {% set _ = cities.append(restaurant.city) %}
                                    <option value="{{ restaurant.city }}">{{ restaurant.city }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Type de Cuisine</label>
                        <select class="form-select filter-select" id="cuisineFilter">
                            <option value="">Tous les types</option>
                            {% set cuisines = [] %}
                            {% for restaurant in restaurants %}
                                {% if restaurant.cuisine_type not in cuisines %}
                                    {% set _ = cuisines.append(restaurant.cuisine_type) %}
                                    <option value="{{ restaurant.cuisine_type }}">{{ restaurant.cuisine_type }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Note Minimum</label>
                        <select class="form-select filter-select" id="ratingFilter">
                            <option value="">Toutes les notes</option>
                            <option value="4">⭐ 4+ étoiles</option>
                            <option value="3">⭐ 3+ étoiles</option>
                            <option value="2">⭐ 2+ étoiles</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Recherche</label>
                        <div class="search-box">
                            <input type="text" class="form-control" id="searchInput" placeholder="Rechercher un restaurant...">
                            <i class="fas fa-search search-icon"></i>
                        </div>
                    </div>
                    
                    <button class="btn btn-outline-primary w-100 mt-3" id="clearFilters">
                        <i class="fas fa-times me-2"></i>Effacer les filtres
                    </button>
                    
                    <!-- Quick Links -->
                    <div class="quick-links mt-4">
                        <h5>Liens Rapides</h5>
                        <ul class="list-unstyled">
                            <li><a href="#"><i class="fas fa-map-marker-alt me-2"></i>Plan des restaurants</a></li>
                            <li><a href="#"><i class="fas fa-clock me-2"></i>Horaires d'ouverture</a></li>
                            <li><a href="#"><i class="fas fa-phone me-2"></i>Réservations</a></li>
                            <li><a href="#"><i class="fas fa-utensils me-2"></i>Menus spéciaux</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Restaurant Cards -->
            <div class="col-lg-9">
                <div class="restaurant-header mb-4" data-aos="fade-up">
                    <h2>Restaurants Disponibles</h2>
                    <p class="text-muted">Savourez une expérience culinaire exceptionnelle</p>
                </div>
                
                <div class="row" id="restaurantCards">
                    {% for restaurant in restaurants %}
                    <div class="col-md-6 col-lg-4 mb-4 restaurant-card" 
                         data-city="{{ restaurant.city }}" 
                         data-cuisine="{{ restaurant.cuisine_type }}"
                         data-rating="{{ restaurant.rating or 0 }}"
                         data-aos="fade-up" 
                         data-aos-delay="{{ loop.index0 * 100 }}">
                        <div class="restaurant-item">
                            <div class="restaurant-badge">
                                <i class="fas fa-utensils"></i>
                            </div>
                            
                            <div class="restaurant-content">
                                <h4 class="restaurant-name">{{ restaurant.name }}</h4>
                                <p class="restaurant-description">{{ restaurant.description or 'Restaurant de qualité offrant une cuisine authentique et savoureuse.' }}</p>
                                
                                <div class="restaurant-details">
                                    <div class="detail-item">
                                        <i class="fas fa-map-marker-alt"></i>
                                        <span>{{ restaurant.city }}</span>
                                    </div>
                                    <div class="detail-item">
                                        <i class="fas fa-tag"></i>
                                        <span>{{ restaurant.cuisine_type }}</span>
                                    </div>
                                    {% if restaurant.rating and restaurant.rating > 0 %}
                                    <div class="detail-item rating">
                                        <div class="rating-stars">
                                            {% for i in range(5) %}
                                                {% if i < restaurant.rating %}
                                                <i class="fas fa-star"></i>
                                                {% else %}
                                                <i class="far fa-star"></i>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                        <span class="rating-text">{{ restaurant.rating }}/5</span>
                                    </div>
                                    {% endif %}
                                    {% if restaurant.phone %}
                                    <div class="detail-item">
                                        <i class="fas fa-phone"></i>
                                        <span>{{ restaurant.phone }}</span>
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="restaurant-actions">
                                    <button class="btn btn-primary btn-sm">
                                        <i class="fas fa-phone me-1"></i>Appeler
                                    </button>
                                    <button class="btn btn-outline-primary btn-sm">
                                        <i class="fas fa-info-circle me-1"></i>Détails
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <!-- No Results Message -->
                <div id="noResults" class="text-center py-5" style="display: none;">
                    <i class="fas fa-search fa-3x text-muted mb-3"></i>
                    <h4 class="text-muted">Aucun restaurant trouvé</h4>
                    <p class="text-muted">Essayez de modifier vos critères de recherche</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Restaurant Info Section -->
<section id="restaurant-info" class="py-5 bg-light">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mx-auto text-center" data-aos="fade-up">
                <h2 class="mb-4">Services & Informations</h2>
                <p class="lead mb-5">Tout ce que vous devez savoir sur nos services de restauration</p>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-4 mb-4" data-aos="fade-up" data-aos-delay="100">
                <div class="info-card">
                    <div class="info-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <h4>Horaires</h4>
                    <p>Nos restaurants sont ouverts selon les horaires de vol pour vous servir à tout moment de votre voyage</p>
                </div>
            </div>
            
            <div class="col-md-4 mb-4" data-aos="fade-up" data-aos-delay="200">
                <div class="info-card">
                    <div class="info-icon">
                        <i class="fas fa-leaf"></i>
                    </div>
                    <h4>Cuisine Locale</h4>
                    <p>Découvrez les saveurs authentiques du Maroc avec nos plats traditionnels préparés par des chefs expérimentés</p>
                </div>
            </div>
            
            <div class="col-md-4 mb-4" data-aos="fade-up" data-aos-delay="300">
                <div class="info-card">
                    <div class="info-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h4>Qualité</h4>
                    <p>Tous nos restaurants respectent les plus hauts standards de qualité et d'hygiène alimentaire</p>
                </div>
            </div>
        </div>
    </div>
</section>

<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
// Initialize AOS
AOS.init({
    duration: 800,
    easing: 'ease-in-out',
    once: true
});

// Restaurant filtering functionality
document.addEventListener('DOMContentLoaded', function() {
    const cityFilter = document.getElementById('cityFilter');
    const cuisineFilter = document.getElementById('cuisineFilter');
    const ratingFilter = document.getElementById('ratingFilter');
    const searchInput = document.getElementById('searchInput');
    const clearFilters = document.getElementById('clearFilters');
    const restaurantCards = document.querySelectorAll('.restaurant-card');
    const noResults = document.getElementById('noResults');

    function filterRestaurants() {
        const selectedCity = cityFilter.value.toLowerCase();
        const selectedCuisine = cuisineFilter.value.toLowerCase();
        const selectedRating = parseFloat(ratingFilter.value) || 0;
        const searchTerm = searchInput.value.toLowerCase();
        let visibleCount = 0;

        restaurantCards.forEach(card => {
            const cardCity = card.getAttribute('data-city').toLowerCase();
            const cardCuisine = card.getAttribute('data-cuisine').toLowerCase();
            const cardRating = parseFloat(card.getAttribute('data-rating')) || 0;
            const cardText = card.textContent.toLowerCase();

            const cityMatch = !selectedCity || cardCity.includes(selectedCity);
            const cuisineMatch = !selectedCuisine || cardCuisine.includes(selectedCuisine);
            const ratingMatch = cardRating >= selectedRating;
            const searchMatch = !searchTerm || cardText.includes(searchTerm);

            if (cityMatch && cuisineMatch && ratingMatch && searchMatch) {
                card.style.display = 'block';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });

        // Show/hide no results message
        noResults.style.display = visibleCount === 0 ? 'block' : 'none';
    }

    function clearAllFilters() {
        cityFilter.value = '';
        cuisineFilter.value = '';
        ratingFilter.value = '';
        searchInput.value = '';
        filterRestaurants();
    }

    // Event listeners
    cityFilter.addEventListener('change', filterRestaurants);
    cuisineFilter.addEventListener('change', filterRestaurants);
    ratingFilter.addEventListener('change', filterRestaurants);
    searchInput.addEventListener('input', filterRestaurants);
    clearFilters.addEventListener('click', clearAllFilters);

    // Smooth scrolling for hero buttons
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
});
</script>
{% endblock %}
