{% extends 'admin/dashboard.html' %}
{% block content %}
<div class="container my-4">
    <h2 class="mb-4">Gestion des offres d'emploi</h2>
    <a href="#" class="btn btn-success mb-3" data-bs-toggle="modal" data-bs-target="#addJobOfferModal"><i class="fas fa-plus"></i> Ajouter une offre</a>
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>Titre</th>
                <th>Référence</th>
                <th>Département</th>
                <th>Lieu</th>
                <th>Date limite</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for job in jobs %}
            <tr>
                <td>{{ job.title }}</td>
                <td>{{ job.reference }}</td>
                <td>{{ job.department }}</td>
                <td>{{ job.location }}</td>
                <td>{{ job.deadline.strftime('%d/%m/%Y') }}</td>
                <td>
                    {% if job.status == 'active' %}
                        <span class="badge bg-success">Active</span>
                    {% else %}
                        <span class="badge bg-secondary">Inactive</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{{ url_for('admin_edit_job_offer', job_id=job.id) }}" class="btn btn-sm btn-primary"><i class="fas fa-edit"></i></a>
                    <a href="{{ url_for('admin_delete_job_offer', job_id=job.id) }}" class="btn btn-sm btn-danger" onclick="return confirm('Supprimer cette offre ?');"><i class="fas fa-trash"></i></a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% if not jobs %}
        <div class="alert alert-info">Aucune offre d'emploi enregistrée.</div>
    {% endif %}
</div>
<!-- MODAL AJOUT OFFRE D'EMPLOI -->
<div class="modal fade" id="addJobOfferModal" tabindex="-1" aria-labelledby="addJobOfferModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="POST" action="{{ url_for('admin_job_offers') }}">
        <div class="modal-header">
          <h5 class="modal-title" id="addJobOfferModalLabel">Ajouter une offre d'emploi</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="title" class="form-label">Titre</label>
            <input type="text" class="form-control" id="title" name="title" required>
          </div>
          <div class="mb-3">
            <label for="reference" class="form-label">Référence</label>
            <input type="text" class="form-control" id="reference" name="reference" required>
          </div>
          <div class="mb-3">
            <label for="department" class="form-label">Département</label>
            <input type="text" class="form-control" id="department" name="department" required>
          </div>
          <div class="mb-3">
            <label for="location" class="form-label">Lieu</label>
            <input type="text" class="form-control" id="location" name="location" required>
          </div>
          <div class="mb-3">
            <label for="deadline" class="form-label">Date limite</label>
            <input type="date" class="form-control" id="deadline" name="deadline" required>
          </div>
          <div class="mb-3">
            <label for="contract_type" class="form-label">Type de contrat</label>
            <input type="text" class="form-control" id="contract_type" name="contract_type" required>
          </div>
          <div class="mb-3">
            <label for="experience_level" class="form-label">Niveau d'expérience</label>
            <input type="text" class="form-control" id="experience_level" name="experience_level">
          </div>
          <div class="mb-3">
            <label for="description" class="form-label">Description</label>
            <textarea class="form-control" id="description" name="description" rows="3"></textarea>
          </div>
          <div class="mb-3">
            <label for="requirements" class="form-label">Exigences</label>
            <textarea class="form-control" id="requirements" name="requirements" rows="2"></textarea>
          </div>
          <div class="mb-3">
            <label for="contact_email" class="form-label">Email de contact</label>
            <input type="email" class="form-control" id="contact_email" name="contact_email">
          </div>
          <div class="mb-3">
            <label for="contact_phone" class="form-label">Téléphone de contact</label>
            <input type="text" class="form-control" id="contact_phone" name="contact_phone">
          </div>
          <input type="hidden" name="status" value="active">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
          <button type="submit" class="btn btn-primary">Ajouter</button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
